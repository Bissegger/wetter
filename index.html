<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>NASA-Style WEATHER-AI Final mit Ladebalken</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Orbitron:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/controls/OrbitControls.js"></script>
<style>
body{margin:0; background:#05070d; overflow:hidden; font-family:'Inter',sans-serif;}
canvas{display:block;}
/* Ladebildschirm */
#loader{
  position:absolute;top:0;left:0;width:100%;height:100%;background:#05070d;display:flex;align-items:center;justify-content:center;flex-direction:column;color:white;z-index:100;
}
#progressBarContainer{width:300px;height:20px;border:1px solid #fff;border-radius:10px;margin-top:10px;overflow:hidden;}
#progressBar{height:100%;width:0%;background:#00eaff;}
#topbar{position:absolute;top:0;left:0;right:0;height:60px;display:flex;align-items:center;gap:20px;padding:0 20px;background:linear-gradient(#0c1220,#060912);border-bottom:1px solid #1b2a44;z-index:10;}
#logo{font-family:'Orbitron';letter-spacing:1px;}
.tab{padding:8px 16px;border-radius:10px;cursor:pointer;color:#9fb8ff;transition:.25s;}
.tab.active{background:linear-gradient(180deg,#142a55,#0c1a36);color:white;box-shadow:0 0 14px rgba(0,160,255,.6);}
#left{position:absolute;top:60px;left:0;bottom:50px;width:260px;padding:14px;background:rgba(8,12,25,.85);border-right:1px solid #1b2a44;z-index:5;}
.panel{background:rgba(10,16,30,.85);border:1px solid #1b2a44;border-radius:12px;padding:12px;margin-bottom:10px;cursor:pointer;transition:.25s;}
.panel:hover{box-shadow:0 0 16px rgba(0,234,255,.35);transform:translateX(2px);}
#bottom{position:absolute;bottom:0;left:260px;right:0;height:50px;display:flex;align-items:center;gap:20px;padding:0 16px;background:#0b132b;border-top:1px solid #1b2a44;font-size:13px;z-index:5;}
#alerts{position:absolute;right:20px;bottom:70px;width:280px;background:linear-gradient(180deg,#3b0d0d,#1a0505);border:1px solid #ff3b3b;border-radius:14px;padding:14px;box-shadow:0 0 25px rgba(255,60,60,.5);animation:pulse 1.8s infinite;z-index:6;}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)}}
#timelineBox{margin-left:auto;display:flex;align-items:center;gap:10px;}
input[type=range]{width:220px;appearance:none;height:4px;background:linear-gradient(90deg,#2d6cdf,#00eaff,#ff9f1c);border-radius:4px;}
input[type=range]::-webkit-slider-thumb{appearance:none;width:16px;height:16px;border-radius:50%;background:white;box-shadow:0 0 12px #00eaff;}
</style>
</head>
<body>

<!-- Ladebildschirm -->
<div id="loader">
  <div>Lade Wetter-Globus...</div>
  <div id="progressBarContainer"><div id="progressBar"></div></div>
</div>

<!-- UI -->
<div id="topbar">
  <div id="logo">WEATHER-AI NASA</div>
  <div class="tab active" onclick="setMode('3d')">3D Globus</div>
  <div class="tab" onclick="setMode('2d')">2D Karte</div>
  <div class="tab" onclick="setMode('4d')">4D Wetterkarte</div>
  <div id="timelineBox">
    <span>‚è±</span>
    <input type="range" min="-72" max="72" value="0" id="time">
  </div>
</div>
<div id="left">
  <div class="panel" onclick="setWeather('temperature')">üå° Temperatur</div>
  <div class="panel" onclick="setWeather('precipitation')">üåß Niederschlag</div>
  <div class="panel" onclick="setWeather('wind')">üå¨ Wind</div>
</div>
<div id="alerts">
  <strong>EXTREM-WETTERALARM</strong><br><br>
  üî¥ Hurrikan IRIS ‚Äì Kategorie 4<br>
  üü† Tornado-Warnung ‚Äì Mittel<br>
  üî¥ Starkregen ‚Äì Hoch
</div>
<div id="bottom">
  üå° 28 ¬∞C üå¨ 75 km/h üåß 12 mm
</div>

<script>
// Szene & Kamera
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0,1.4,4);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);
const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
renderer.outputEncoding = THREE.sRGBEncoding;
renderer.toneMapping = THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure = 1.0;

// Licht
scene.add(new THREE.AmbientLight(0xffffff,0.5));
const keyLight = new THREE.DirectionalLight(0xffffff,1.0);
keyLight.position.set(5,3,5);
scene.add(keyLight);
const fillLight = new THREE.DirectionalLight(0xffffff,0.4);
fillLight.position.set(-5,-3,2);
scene.add(fillLight);

// Lade Manager mit Fortschritt
const manager = new THREE.LoadingManager();
const progressBar = document.getElementById("progressBar");
manager.onProgress = function(url, loaded, total){
    progressBar.style.width = ((loaded/total)*100) + "%";
};
manager.onLoad = function(){
    // Verstecke Ladebildschirm
    document.getElementById("loader").style.display = "none";
    animate();
};

const loader = new THREE.TextureLoader(manager);
let earthTexture = loader.load('https://threejs.org/examples/textures/planets/earth_atmos_2048.jpg');
let earthLights = loader.load('https://threejs.org/examples/textures/planets/earth_lights_2048.png');
let cloudTexture = loader.load('https://threejs.org/examples/textures/planets/earth_clouds_1024.png');

let earth, clouds, overlay3D, map2D;

function initScene(){
  earth = new THREE.Mesh(new THREE.SphereGeometry(1,64,64), new THREE.MeshPhongMaterial({
    map:earthTexture, emissiveMap:earthLights, emissive:0xffffff, emissiveIntensity:0.6, shininess:5
  }));
  scene.add(earth);
  
  clouds = new THREE.Mesh(new THREE.SphereGeometry(1.01,64,64), new THREE.MeshPhongMaterial({
    map:cloudTexture, transparent:true, opacity:0.8, depthWrite:false
  }));
  scene.add(clouds);
  
  const atmosphere = new THREE.Mesh(new THREE.SphereGeometry(1.05,64,64), new THREE.MeshBasicMaterial({
    color:0x66ccff, transparent:true, opacity:0.15, side:THREE.BackSide
  }));
  scene.add(atmosphere);
  
  const hurricaneGroup = new THREE.Group();
  scene.add(hurricaneGroup);
  for(let i=0;i<6;i++){
    const torus = new THREE.Mesh(new THREE.TorusGeometry(0.18+i*0.02,0.025,16,100), new THREE.MeshBasicMaterial({
      color:0xff3300, transparent:true, opacity:0.6-i*0.08
    }));
    torus.rotation.x = Math.PI/2;
    hurricaneGroup.add(torus);
  }
  hurricaneGroup.position.set(0.6,0.2,0.8);
  
  const weatherMaps={temperature:0xffcc00, precipitation:0x0066ff, wind:0x33ff33};
  overlay3D = new THREE.Mesh(new THREE.SphereGeometry(1.03,64,64), new THREE.MeshStandardMaterial({
    color:weatherMaps.temperature, transparent:true, opacity:0.5
  }));
  scene.add(overlay3D);
  map2D = new THREE.Mesh(new THREE.PlaneGeometry(4,2), new THREE.MeshBasicMaterial({
    color:weatherMaps.temperature, transparent:true, opacity:0.8
  }));
  map2D.visible = false;
  scene.add(map2D);
}

initScene();

let mode="3d";
function setMode(m){
  mode=m;
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  event.target.classList.add('active');
  if(m==="2d"){
    camera.position.set(0,0,3);
    controls.enableRotate=false;
    map2D.visible=true;
    earth.visible=false;
    clouds.visible=false;
    overlay3D.visible=false;
  } else {
    map2D.visible=false;
    earth.visible=true;
    clouds.visible=true;
    overlay3D.visible=true;
    controls.enableRotate=true;
    if(m==="3d") camera.position.set(0,0,4);
    if(m==="4d") camera.position.set(0,1.4,4);
  }
}

function setWeather(type){
  const weatherMaps={temperature:0xffcc00, precipitation:0x0066ff, wind:0x33ff33};
  let color = weatherMaps.temperature;
  if(type==="precipitation") color=weatherMaps.precipitation;
  if(type==="wind") color=weatherMaps.wind;
  overlay3D.material.color.set(color);
  map2D.material.color.set(color);
}

const timeSlider=document.getElementById("time");

function animate(){
  requestAnimationFrame(animate);
  if(!earth) return;
  earth.rotation.y += 0.001;
  clouds.rotation.y += 0.0012;
  overlay3D.rotation.y += 0.0012;
  scene.traverse(obj=>{if(obj.type==='Group') obj.rotation.z+=0.03;});
  controls.update();
  renderer.render(scene,camera);
}

window.addEventListener('resize',()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>
</body>
</html>
